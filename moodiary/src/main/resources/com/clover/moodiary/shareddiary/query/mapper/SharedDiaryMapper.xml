<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.clover.moodiary.shareddiary.query.mapper.SharedDiaryMapper">

    <select id="findDiaryByRoomId" resultType="com.clover.moodiary.shareddiary.query.dto.SharedDiaryResponse">
        SELECT
            id,
            title,
            content,
            DATE_FORMAT(created_at, '%Y-%m-%d %H:%i:%s') AS createdAt,
            user_id AS userId,
            is_deleted AS isDeleted,
            fixed_state AS fixedState
        FROM shared_diary
        WHERE shared_diary_room_id = #{roomId}
          AND is_deleted = false
        ORDER BY created_at DESC
    </select>

    <select id="findDiaryById" resultType="com.clover.moodiary.shareddiary.query.dto.SharedDiaryDetailResponse">
        SELECT
            id,
            title,
            content,
            DATE_FORMAT(created_at, '%Y-%m-%d %H:%i:%s') AS createdAt,
            is_deleted AS isDeleted,
            fixed_state AS fixedState,
            user_id AS userId,
            style_layer AS styleLayer
        FROM shared_diary
        WHERE id = #{diaryId}
    </select>
</mapper>